<Window xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:System="clr-namespace:System;assembly=mscorlib"
        xmlns:CodeAnalysis="clr-namespace:Microsoft.CodeAnalysis;assembly=Microsoft.CodeAnalysis"
        Title="VB Code Compiler"
        Height="620" Width="600">
    <Window.Resources>
        <ObjectDataProvider x:Key="dataFromEnum" MethodName="GetValues"
                            ObjectType="{x:Type System:Enum}">
            <ObjectDataProvider.MethodParameters>
                <x:Type TypeName="CodeAnalysis:OutputKind"/>
            </ObjectDataProvider.MethodParameters>
        </ObjectDataProvider>
    </Window.Resources>
    <Grid>
        <StackPanel Width="120" Margin="450,20,0,0">
            <Button Command="{Binding AddCodeCommand}" 
                    Content="Compile" 
                    HorizontalAlignment="Left" 
                    VerticalAlignment="Top" 
                    Width="120"/>
            <Label Content="Kind of output:" 
                   HorizontalAlignment="Left" 
                   VerticalAlignment="Top" 
                   Width="128"/>
            <ComboBox HorizontalAlignment="Left" 
                      VerticalAlignment="Top" 
                      Width="120"
                      ItemsSource="{Binding Source={StaticResource dataFromEnum}}"
                      SelectedItem="{Binding SelectedOutputKind}"/>
        </StackPanel>
        <TextBox Text="{Binding CodeText, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                 HorizontalAlignment="Left" 
                 Height="243" 
                 Margin="10,10,0,0" 
                 VerticalAlignment="Top" 
                 Width="439"
                 AcceptsReturn="True"
                 TextWrapping="Wrap"
                 VerticalScrollBarVisibility="Auto"
                 FontFamily="Consolas"/>
        <Label Content="Errors:" 
               HorizontalAlignment="Left" 
               Margin="22,266,0,0" 
               VerticalAlignment="Top" 
               Width="60"/>
        <ListBox ItemsSource="{Binding ErrorsList}" 
                 HorizontalAlignment="Left" 
                 Height="90" 
                 Margin="88,266,0,0" 
                 VerticalAlignment="Top" 
                 Width="334"/>
        <Label Content="Methods:" 
               HorizontalAlignment="Left" 
               Margin="22,361,0,0" 
               VerticalAlignment="Top"/>
        <ListBox ItemsSource="{Binding MethodDisplays}" 
                 SelectedItem="{Binding SelectedMethod, Mode=TwoWay}"
                 DisplayMemberPath="DisplayText"
                 HorizontalAlignment="Left" 
                 Height="90" 
                 Margin="88,361,0,0" 
                 VerticalAlignment="Top" 
                 Width="334"/>
        <Label Content="Variables:" 
               HorizontalAlignment="Left" 
               Margin="22,456,0,0" 
               VerticalAlignment="Top"/>
        <ListBox ItemsSource="{Binding FieldDisplays}" 
                 SelectedItem="{Binding SelectedField, Mode=TwoWay}"
                 DisplayMemberPath="DisplayText"
                 HorizontalAlignment="Left" 
                 Height="90" 
                 Margin="88,456,0,0" 
                 VerticalAlignment="Top" 
                 Width="334"/>
        <Label Content="Parameter:" 
               HorizontalAlignment="Left" 
               Margin="450,253,0,0" 
               VerticalAlignment="Top" 
               Width="80" RenderTransformOrigin="0.526,-0.893"/>
        <TextBox Text="{Binding MethodParameter, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                 HorizontalAlignment="Left" 
                 Height="21" 
                 Margin="450,279,0,0" 
                 TextWrapping="Wrap" 
                 VerticalAlignment="Top" 
                 Width="120"/>
        <Button Command="{Binding InvokeMethodCommand}"
                Content="INVOKE" 
                HorizontalAlignment="Left" 
                Margin="450,305,0,0" 
                VerticalAlignment="Top" 
                Width="120" RenderTransformOrigin="0.475,-0.704"/>
        <Label Content="Result:" 
               HorizontalAlignment="Left" 
               Margin="450,325,0,0" 
               VerticalAlignment="Top" 
               Width="67"/>
        <TextBox Text="{Binding MethodResult, Mode=OneWay}"
                 HorizontalAlignment="Left" 
                 Height="62" 
                 Margin="450,351,0,0" 
                 TextWrapping="Wrap" 
                 VerticalAlignment="Top" 
                 Width="120"
                 IsReadOnly="True"
                 VerticalScrollBarVisibility="Auto"/>
        <Label Content="Current Value:" 
               HorizontalAlignment="Left" 
               Margin="450,415,0,0" 
               VerticalAlignment="Top" 
               Width="120"/>
        <TextBox Text="{Binding CurrentFieldValue, Mode=OneWay}"
                 HorizontalAlignment="Left" 
                 Height="23" 
                 Margin="450,441,0,0" 
                 TextWrapping="Wrap" 
                 VerticalAlignment="Top" 
                 Width="120"
                 IsReadOnly="True"
                 Background="LightGray"/>
        <Label Content="New Value:" 
               HorizontalAlignment="Left" 
               Margin="450,464,0,0" 
               VerticalAlignment="Top" 
               Width="120" RenderTransformOrigin="0.512,-1.232"/>
        <TextBox Text="{Binding NewFieldValue, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                 HorizontalAlignment="Left" 
                 Height="22" 
                 Margin="450,490,0,0" 
                 TextWrapping="Wrap" 
                 VerticalAlignment="Top" 
                 Width="120"/>
        <Button Command="{Binding SetFieldCommand}"
                Content="SET" 
                HorizontalAlignment="Left" 
                Margin="450,517,0,0" 
                VerticalAlignment="Top" 
                Width="120"/>
    </Grid>
</Window>